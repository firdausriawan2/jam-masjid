"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{4352:(e,a,s)=>{s.r(a),s.d(a,{default:()=>K});var t=s(5155),r=s(2115),n=s(2296),l=s(5500),i=s(7765),c=s(710),d=s(2227),o=s(517),x=s(8960),m=s(2177),h=s(5594),u=s(221),g=s(4500),p=s(9337),b=s(6884),j=s(4393),f=s(2975);let y=h.z.object({type:h.z.enum(["income","expense"]),category:h.z.string().min(1,"Kategori harus diisi"),amount:h.z.coerce.number().positive("Jumlah harus lebih dari 0"),description:h.z.string().min(1,"Deskripsi harus diisi"),date:h.z.string().min(1,"Tanggal harus diisi")});function N(e){let{onSubmit:a,initialData:s={},isEditing:n=!1,onCancel:l}=e,[i,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(null),[h,N]=(0,r.useState)(null),{register:v,handleSubmit:w,reset:k,watch:S,formState:{errors:T}}=(0,m.mN)({resolver:(0,u.u)(y),defaultValues:{type:s.type||"income",category:s.category||"",amount:s.amount||0,description:s.description||"",date:s.date||new Date().toISOString().split("T")[0]}}),D=S("type"),L=async e=>{c(!0),o(null),N(null);try{let t=await a({...e,category:e.category,proofUrl:s.proofUrl});t.success?(N(n?"Transaksi berhasil diperbarui!":"Transaksi berhasil ditambahkan!"),n||(k(),setTimeout(()=>N(null),3e3))):o(t.error||"Terjadi kesalahan. Silakan coba lagi.")}catch(e){o("Terjadi kesalahan. Silakan coba lagi."),console.error("Form submission error:",e)}finally{c(!1)}};return(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(x.A,{className:"w-5 h-5 text-green-600"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:n?"Edit Transaksi":"Tambah Transaksi Baru"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:n?"Perbarui informasi transaksi":"Masukkan detail transaksi keuangan masjid"})]})]}),(0,t.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,t.jsx)(g.A,{className:"w-6 h-6"})})]})}),(0,t.jsxs)("div",{className:"p-6",children:[d&&(0,t.jsx)("div",{className:"mb-6 rounded-lg bg-red-50 border border-red-200 p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(g.A,{className:"h-5 w-5 text-red-400"})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Terjadi Kesalahan"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-red-700",children:d})]})]})}),h&&(0,t.jsx)("div",{className:"mb-6 rounded-lg bg-green-50 border border-green-200 p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(p.A,{className:"h-5 w-5 text-green-400"})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Berhasil!"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-green-700",children:h})]})]})}),(0,t.jsxs)("form",{onSubmit:w(L),className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700 block mb-3",children:"Jenis Transaksi"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("label",{className:"relative flex cursor-pointer rounded-lg border p-4 transition-all duration-200 ".concat("income"===D?"border-green-500 bg-green-50 ring-2 ring-green-500":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,t.jsx)("input",{type:"radio",value:"income",...v("type"),className:"sr-only"}),(0,t.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto h-8 w-8 rounded-full flex items-center justify-center mb-2 ".concat("income"===D?"bg-green-100":"bg-gray-100"),children:(0,t.jsx)("svg",{className:"h-4 w-4 ".concat("income"===D?"text-green-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,t.jsx)("div",{className:"text-sm font-medium ".concat("income"===D?"text-green-900":"text-gray-900"),children:"Pemasukan"}),(0,t.jsx)("div",{className:"text-xs ".concat("income"===D?"text-green-600":"text-gray-500"),children:"Dana masuk"})]})})]}),(0,t.jsxs)("label",{className:"relative flex cursor-pointer rounded-lg border p-4 transition-all duration-200 ".concat("expense"===D?"border-red-500 bg-red-50 ring-2 ring-red-500":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,t.jsx)("input",{type:"radio",value:"expense",...v("type"),className:"sr-only"}),(0,t.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto h-8 w-8 rounded-full flex items-center justify-center mb-2 ".concat("expense"===D?"bg-red-100":"bg-gray-100"),children:(0,t.jsx)("svg",{className:"h-4 w-4 ".concat("expense"===D?"text-red-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,t.jsx)("div",{className:"text-sm font-medium ".concat("expense"===D?"text-red-900":"text-gray-900"),children:"Pengeluaran"}),(0,t.jsx)("div",{className:"text-xs ".concat("expense"===D?"text-red-600":"text-gray-500"),children:"Dana keluar"})]})})]})]}),T.type&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:T.type.message})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"date",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(b.A,{className:"w-4 h-4 mr-2 text-gray-500"}),"Tanggal"]}),(0,t.jsx)("input",{type:"date",id:"date",...v("date"),className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 text-sm p-3"}),T.date&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.date.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"amount",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(x.A,{className:"w-4 h-4 mr-2 text-gray-500"}),"Jumlah (Rp)"]}),(0,t.jsx)("input",{type:"number",id:"amount",...v("amount"),className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 text-sm p-3",placeholder:"0",min:"0"}),T.amount&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.amount.message})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"category",className:"flex items-center text-sm font-medium text-gray-700 mb-3",children:[(0,t.jsx)(j.A,{className:"w-4 h-4 mr-2 text-gray-500"}),"Kategori"]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:("income"===D?[{value:"infaq",label:"Infaq",description:"Sumbangan sukarela"},{value:"sedekah",label:"Sedekah",description:"Sedekah dari jamaah"},{value:"zakat",label:"Zakat",description:"Zakat fitrah/mal"},{value:"wakaf",label:"Wakaf",description:"Wakaf tunai/barang"},{value:"lainnya",label:"Lainnya",description:"Pemasukan lain-lain"}]:[{value:"listrik",label:"Listrik",description:"Tagihan listrik"},{value:"air",label:"Air",description:"Tagihan air"},{value:"kebersihan",label:"Kebersihan",description:"Peralatan kebersihan"},{value:"perbaikan",label:"Perbaikan",description:"Perbaikan fasilitas"},{value:"gaji_marbot",label:"Gaji Marbot",description:"Gaji petugas"},{value:"lainnya",label:"Lainnya",description:"Pengeluaran lain-lain"}]).map(e=>(0,t.jsxs)("label",{className:"relative flex cursor-pointer rounded-lg border p-3 transition-all duration-200 ".concat(S("category")===e.value?"border-green-500 bg-green-50 ring-1 ring-green-500":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,t.jsx)("input",{type:"radio",value:e.value,...v("category"),className:"sr-only"}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium ".concat(S("category")===e.value?"text-green-900":"text-gray-900"),children:e.label}),(0,t.jsx)("div",{className:"text-xs ".concat(S("category")===e.value?"text-green-600":"text-gray-500"),children:e.description})]}),S("category")===e.value&&(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(p.A,{className:"h-4 w-4 text-green-600"})})]},e.value))}),T.category&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:T.category.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"description",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(f.A,{className:"w-4 h-4 mr-2 text-gray-500"}),"Deskripsi"]}),(0,t.jsx)("textarea",{id:"description",rows:3,...v("description"),className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 text-sm p-3",placeholder:"Masukkan deskripsi detail transaksi..."}),T.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.description.message})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:l,className:"order-2 sm:order-1 inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200",children:"Batal"}),(0,t.jsx)("button",{type:"submit",disabled:i,className:"order-1 sm:order-2 flex-1 sm:flex-none inline-flex justify-center items-center px-6 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n?"Memperbarui...":"Menyimpan..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.A,{className:"w-4 h-4 mr-2"}),n?"Perbarui Transaksi":"Simpan Transaksi"]})})]})]})]})]})}var v=s(8046),w=s(5233),k=s(5628),S=s(5713),T=s(6784),D=s(1316),L=s(1151);function C(e){let{transactions:a,onDelete:s,onUpdate:l}=e,[i,c]=(0,r.useState)(null),[d,o]=(0,r.useState)(""),[x,m]=(0,r.useState)("all"),[h,u]=(0,r.useState)(null),[b,j]=(0,r.useState)("date"),[f,y]=(0,r.useState)("desc"),C=a.filter(e=>{let a=e.description.toLowerCase().includes(d.toLowerCase())||e.category.toLowerCase().includes(d.toLowerCase()),s="all"===x||e.type===x;return a&&s}).sort((e,a)=>{let s=0;switch(b){case"date":s=new Date(e.date).getTime()-new Date(a.date).getTime();break;case"amount":s=e.amount-a.amount;break;case"description":s=e.description.localeCompare(a.description)}return"asc"===f?s:-s}),A=e=>{c(e)},M=async e=>{if(!i)return{success:!1,error:"No transaction selected for editing"};let a=await l(i.id,e);return a.success&&c(null),a},I=e=>{u(e)},P=()=>{u(null)},B=async e=>{let a=await s(e);return a.success&&u(null),a},R=e=>({infaq:"Infaq",sedekah:"Sedekah",zakat:"Zakat",wakaf:"Wakaf",listrik:"Listrik",air:"Air",kebersihan:"Kebersihan",perbaikan:"Perbaikan",gaji_marbot:"Gaji Marbot",lainnya:"Lainnya"})[e]||e;return i?(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsx)(N,{onSubmit:M,initialData:i,isEditing:!0,onCancel:()=>{c(null)}})}):(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Daftar Transaksi"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[C.length," dari ",a.length," transaksi"]})]})})}),(0,t.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(v.A,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("input",{type:"text",value:d,onChange:e=>o(e.target.value),placeholder:"Cari deskripsi atau kategori...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-green-500 focus:border-green-500 text-sm"})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 rounded-lg text-sm",children:[(0,t.jsx)("option",{value:"all",children:"Semua Tipe"}),(0,t.jsx)("option",{value:"income",children:"Pemasukan"}),(0,t.jsx)("option",{value:"expense",children:"Pengeluaran"})]})}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 rounded-lg text-sm",children:[(0,t.jsx)("option",{value:"date",children:"Urutkan: Tanggal"}),(0,t.jsx)("option",{value:"amount",children:"Urutkan: Jumlah"}),(0,t.jsx)("option",{value:"description",children:"Urutkan: Deskripsi"})]}),(0,t.jsx)("button",{onClick:()=>y("asc"===f?"desc":"asc"),className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-green-500",children:"asc"===f?"↑":"↓"})]})]})}),(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:0===C.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(w.A,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tidak ada transaksi"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:d||"all"!==x?"Tidak ada transaksi yang sesuai dengan filter.":"Belum ada transaksi. Tambahkan transaksi pertama Anda."}),(d||"all"!==x)&&(0,t.jsx)("button",{onClick:()=>{o(""),m("all")},className:"mt-4 text-sm text-green-600 hover:text-green-500",children:"Hapus filter"})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:C.map(e=>(0,t.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-150",children:h===e.id?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(k.A,{className:"h-5 w-5 text-red-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Hapus transaksi ini?"}),(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Tindakan ini tidak dapat dibatalkan."})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>B(e.id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,t.jsx)(p.A,{className:"h-3 w-3 mr-1"}),"Hapus"]}),(0,t.jsxs)("button",{onClick:P,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[(0,t.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"Batal"]})]})]}):(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ".concat("income"===e.type?"bg-green-100":"bg-red-100"),children:"income"===e.type?(0,t.jsx)(S.A,{className:"h-6 w-6 text-green-600"}):(0,t.jsx)(T.A,{className:"h-6 w-6 text-red-600"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.description}),(0,t.jsxs)("p",{className:"text-lg font-semibold ml-4 ".concat("income"===e.type?"text-green-600":"text-red-600"),children:["income"===e.type?"+":"-","Rp ",e.amount.toLocaleString("id-ID")]})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center space-x-4 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,n.GP)(new Date(e.date),"dd MMM yyyy")]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),R(e.category)]}),(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat("income"===e.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"income"===e.type?"Pemasukan":"Pengeluaran"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,t.jsxs)("button",{onClick:()=>A(e),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,t.jsx)(D.A,{className:"h-3 w-3 mr-1"}),"Edit"]}),(0,t.jsxs)("button",{onClick:()=>I(e.id),className:"inline-flex items-center px-3 py-1.5 border border-red-300 text-xs font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,t.jsx)(L.A,{className:"h-3 w-3 mr-1"}),"Hapus"]})]})]})},e.id))})})]})}var A=s(3231),M=s(2944),I=s(8044),P=s(1174),B=s(2771);function R(e){let{transactions:a,currentBalance:s}=e,i=a.length,{totalIncome:c,totalExpense:d}=(0,r.useMemo)(()=>a.reduce((e,a)=>("income"===a.type?e.totalIncome+=a.amount:e.totalExpense+=a.amount,e),{totalIncome:0,totalExpense:0}),[a]),o=new Date,x=(0,A.w)(o),m=(0,M.p)(o),h=(0,r.useMemo)(()=>{let e=a.filter(e=>{let a=new Date(e.date);return a>=x&&a<=m}),s=e.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),t=e.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0);return{transactions:e,income:s,expense:t,balance:s-t}},[a,x,m]),u=(0,A.w)((0,I.a)(o,1)),g=(0,M.p)((0,I.a)(o,1)),p=(0,r.useMemo)(()=>{let e=a.filter(e=>{let a=new Date(e.date);return a>=u&&a<=g}),s=e.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),t=e.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0);return{income:s,expense:t,balance:s-t}},[a,u,g]),b=a.slice(0,5),j=(e,a)=>0===a?100*(e>0):(e-a)/a*100,f=j(h.income,p.income),y=j(h.expense,p.expense),N=j(h.balance,p.balance),v=e=>"".concat(e>=0?"+":"").concat(e.toFixed(1),"%"),w=e=>{let{title:a,value:s,change:r,changeText:n,icon:l,positive:i=!0,bgColor:c="bg-white",iconColor:d="text-gray-600",iconBg:o="bg-gray-100"}=e;return(0,t.jsx)("div",{className:"".concat(c," rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"".concat(o," rounded-lg p-2"),children:(0,t.jsx)(l,{className:"h-6 w-6 ".concat(d)})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:a}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s})]})]}),void 0!==r&&(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"flex items-center ".concat(i?"text-green-600":"text-red-600"),children:[i?(0,t.jsx)(S.A,{className:"h-4 w-4 mr-1"}):(0,t.jsx)(T.A,{className:"h-4 w-4 mr-1"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:v(r)})]}),n&&(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:n})]})]})})};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ringkasan Keuangan"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(w,{title:"Saldo Kas",value:"Rp ".concat(s.toLocaleString("id-ID")),icon:P.A,bgColor:"bg-gradient-to-r from-green-50 to-emerald-50",iconColor:"text-green-600",iconBg:"bg-green-100"}),(0,t.jsx)(w,{title:"Pemasukan Bulan Ini",value:"Rp ".concat(h.income.toLocaleString("id-ID")),change:f,changeText:"dari bulan lalu",icon:S.A,positive:f>=0,iconColor:"text-blue-600",iconBg:"bg-blue-100"}),(0,t.jsx)(w,{title:"Pengeluaran Bulan Ini",value:"Rp ".concat(h.expense.toLocaleString("id-ID")),change:y,changeText:"dari bulan lalu",icon:T.A,positive:y<=0,iconColor:"text-red-600",iconBg:"bg-red-100"}),(0,t.jsx)(w,{title:"Saldo Bulan Ini",value:"Rp ".concat(h.balance.toLocaleString("id-ID")),change:N,changeText:"dari bulan lalu",icon:l.A,positive:N>=0,iconColor:h.balance>=0?"text-green-600":"text-red-600",iconBg:h.balance>=0?"bg-green-100":"bg-red-100"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,t.jsx)(B.A,{className:"h-5 w-5 mr-2 text-gray-600"}),"Transaksi Terbaru"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[b.length," transaksi"]})]}),0===b.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(P.A,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"Belum ada transaksi."}),(0,t.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"Transaksi akan muncul di sini setelah Anda menambahkannya."})]}):(0,t.jsx)("div",{className:"overflow-hidden",children:(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:b.map(e=>(0,t.jsxs)("div",{className:"py-4 flex items-center justify-between hover:bg-gray-50 rounded-lg px-2 transition-colors duration-150",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat("income"===e.type?"bg-green-100":"bg-red-100"),children:"income"===e.type?(0,t.jsx)(S.A,{className:"h-5 w-5 text-green-600"}):(0,t.jsx)(T.A,{className:"h-5 w-5 text-red-600"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500",children:(0,n.GP)(new Date(e.date),"dd MMM yyyy")}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"•"}),(0,t.jsx)("span",{className:"text-xs text-gray-500 capitalize",children:e.category})]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-sm font-semibold ".concat("income"===e.type?"text-green-600":"text-red-600"),children:["income"===e.type?"+":"-","Rp ",e.amount.toLocaleString("id-ID")]})})]},e.id))})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Ringkasan ",(0,n.GP)(o,"MMMM yyyy")]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Pemasukan"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-green-900",children:["Rp ",h.income.toLocaleString("id-ID")]})]}),(0,t.jsx)(S.A,{className:"h-8 w-8 text-green-600"})]})}),(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Pengeluaran"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-red-900",children:["Rp ",h.expense.toLocaleString("id-ID")]})]}),(0,t.jsx)(T.A,{className:"h-8 w-8 text-red-600"})]})}),(0,t.jsx)("div",{className:"".concat(h.balance>=0?"bg-blue-50 border-blue-200":"bg-red-50 border-red-200"," border rounded-lg p-4"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium ".concat(h.balance>=0?"text-blue-800":"text-red-800"),children:"Saldo Bersih"}),(0,t.jsxs)("p",{className:"text-xl font-bold ".concat(h.balance>=0?"text-blue-900":"text-red-900"),children:["Rp ",h.balance.toLocaleString("id-ID")]})]}),(0,t.jsx)(l.A,{className:"h-8 w-8 ".concat(h.balance>=0?"text-blue-600":"text-red-600")})]})})]}),(c>0||d>0)&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)("span",{children:"Proporsi Keuangan Total"}),(0,t.jsxs)("span",{children:[i," transaksi"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-3 rounded-full relative",style:{width:"".concat(c/(c+d)*100,"%")},children:c/(c+d)*100>15&&(0,t.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center text-white text-xs font-medium",children:[Math.round(c/(c+d)*100),"%"]})})}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mt-2",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"Pemasukan: Rp ",c.toLocaleString("id-ID")]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full mr-1"}),"Pengeluaran: Rp ",d.toLocaleString("id-ID")]})]})]})]})]})}function E(){let[e,a]=(0,r.useState)(new Date().getFullYear()),[s,l]=(0,r.useState)(new Date().getMonth()+1),[i,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),h=(0,r.useCallback)(async()=>{try{c(!0),o(null);let a=await fetch("/api/finance/report/monthly?year=".concat(e,"&month=").concat(s));if(!a.ok)throw Error("Gagal mengambil laporan bulanan");let t=await a.json();m(t)}catch(e){console.error("Error fetching monthly report:",e),o("Terjadi kesalahan saat mengambil data. Silakan coba lagi.")}finally{c(!1)}},[e,s]);(0,r.useEffect)(()=>{h()},[h]);let u=Array.from({length:5},(e,a)=>new Date().getFullYear()-a),g=(()=>{if(!x)return[];let e=x.transactions.filter(e=>"income"===e.type),a={};return e.forEach(e=>{let s=e.category;a[s]||(a[s]=0),a[s]+=e.amount}),Object.entries(a).map(e=>{let[a,s]=e;return{category:a,amount:s,percentage:s/x.income*100}})})(),p=(()=>{if(!x)return[];let e=x.transactions.filter(e=>"expense"===e.type),a={};return e.forEach(e=>{let s=e.category;a[s]||(a[s]=0),a[s]+=e.amount}),Object.entries(a).map(e=>{let[a,s]=e;return{category:a,amount:s,percentage:s/x.expense*100}})})();return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Laporan Bulanan"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),(0,t.jsx)("select",{id:"year",value:e,onChange:e=>a(parseInt(e.target.value)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2",children:u.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),(0,t.jsx)("select",{id:"month",value:s,onChange:e=>l(parseInt(e.target.value)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2",children:[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}].map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),i?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):d?(0,t.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[(0,t.jsx)("p",{children:d}),(0,t.jsx)("button",{onClick:h,className:"mt-2 bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded text-sm",children:"Coba Lagi"})]}):x?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Pemasukan"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["Rp ",x.income.toLocaleString("id-ID")]})]}),(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Pengeluaran"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["Rp ",x.expense.toLocaleString("id-ID")]})]}),(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Saldo"}),(0,t.jsxs)("p",{className:"text-2xl font-bold ".concat(x.balance>=0?"text-green-600":"text-red-600"),children:["Rp ",x.balance.toLocaleString("id-ID")]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Pemasukan berdasarkan Kategori"}),0===g.length?(0,t.jsx)("p",{className:"text-gray-500",children:"Tidak ada pemasukan untuk periode ini."}):(0,t.jsx)("div",{className:"space-y-3",children:g.map(e=>{let{category:a,amount:s,percentage:r}=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:a.replace("_"," ")}),(0,t.jsxs)("span",{children:["Rp ",s.toLocaleString("id-ID")," (",r.toFixed(1),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,t.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:"".concat(r,"%")}})})]},a)})})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Pengeluaran berdasarkan Kategori"}),0===p.length?(0,t.jsx)("p",{className:"text-gray-500",children:"Tidak ada pengeluaran untuk periode ini."}):(0,t.jsx)("div",{className:"space-y-3",children:p.map(e=>{let{category:a,amount:s,percentage:r}=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:a.replace("_"," ")}),(0,t.jsxs)("span",{children:["Rp ",s.toLocaleString("id-ID")," (",r.toFixed(1),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,t.jsx)("div",{className:"bg-red-600 h-2.5 rounded-full",style:{width:"".concat(r,"%")}})})]},a)})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Daftar Transaksi"}),0===x.transactions.length?(0,t.jsx)("p",{className:"text-gray-500",children:"Tidak ada transaksi untuk periode ini."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kategori"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipe"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.transactions.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:(0,n.GP)(new Date(e.date),"dd/MM/yyyy")}),(0,t.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,t.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:e.category.replace("_"," ")}),(0,t.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium",children:(0,t.jsxs)("span",{className:"income"===e.type?"text-green-600":"text-red-600",children:["income"===e.type?"+":"-"," Rp ",e.amount.toLocaleString("id-ID")]})}),(0,t.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("income"===e.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"income"===e.type?"Pemasukan":"Pengeluaran"})})]},e.id))})]})})]})]}):(0,t.jsx)("p",{className:"text-gray-500",children:"Pilih tahun dan bulan untuk melihat laporan."})]})})}function F(){let[e,a]=(0,r.useState)(new Date().getFullYear()),[s,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),o=(0,r.useCallback)(async()=>{try{n(!0),i(null);let a=await fetch("/api/finance/report/yearly?year=".concat(e));if(!a.ok)throw Error("Gagal mengambil laporan tahunan");let s=await a.json();d(s)}catch(e){console.error("Error fetching yearly report:",e),i("Terjadi kesalahan saat mengambil data. Silakan coba lagi.")}finally{n(!1)}},[e]);(0,r.useEffect)(()=>{o()},[o]);let x=Array.from({length:5},(e,a)=>new Date().getFullYear()-a),m=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],h={balance:"rgba(59, 130, 246, 0.7)"},u=c?Math.max(...c.monthlyData.flatMap(e=>[e.income,e.expense,Math.abs(e.balance)]),0):0;return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Laporan Tahunan"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),(0,t.jsx)("select",{id:"year",value:e,onChange:e=>a(parseInt(e.target.value)),className:"block w-full md:w-64 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2",children:x.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),s?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):l?(0,t.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[(0,t.jsx)("p",{children:l}),(0,t.jsx)("button",{onClick:o,className:"mt-2 bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded text-sm",children:"Coba Lagi"})]}):c?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Pemasukan"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["Rp ",c.totalIncome.toLocaleString("id-ID")]})]}),(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Pengeluaran"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["Rp ",c.totalExpense.toLocaleString("id-ID")]})]}),(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Saldo Tahunan"}),(0,t.jsxs)("p",{className:"text-2xl font-bold ".concat(c.yearBalance>=0?"text-green-600":"text-red-600"),children:["Rp ",c.yearBalance.toLocaleString("id-ID")]})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium mb-4",children:["Grafik Keuangan Tahunan ",e]}),(0,t.jsx)("div",{className:"relative overflow-x-auto",children:(0,t.jsxs)("div",{className:"min-w-[768px]",children:[(0,t.jsxs)("div",{className:"flex items-center border-b pb-2 mb-2",children:[(0,t.jsx)("div",{className:"w-24 font-medium",children:"Bulan"}),(0,t.jsx)("div",{className:"flex-1 px-2",children:(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm",children:"Pemasukan"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm",children:"Pengeluaran"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm",children:"Saldo"})]})]})})]}),c.monthlyData.map(e=>(0,t.jsxs)("div",{className:"flex items-center py-2 border-b",children:[(0,t.jsx)("div",{className:"w-24 text-sm font-medium",children:m[e.month-1]}),(0,t.jsx)("div",{className:"flex-1 px-2",children:(0,t.jsxs)("div",{className:"relative h-10",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 h-3 bg-green-500 rounded",style:{width:"".concat(e.income/u*100,"%")}}),(0,t.jsx)("div",{className:"absolute top-3.5 left-0 h-3 bg-red-500 rounded",style:{width:"".concat(e.expense/u*100,"%")}}),(0,t.jsx)("div",{className:"absolute top-7 left-0 h-3 bg-blue-500 rounded",style:{width:"".concat(Math.abs(e.balance)/u*100,"%"),backgroundColor:e.balance>=0?h.balance:"rgba(239, 68, 68, 0.5)"}})]})}),(0,t.jsxs)("div",{className:"w-52 text-right space-y-0.5",children:[(0,t.jsxs)("div",{className:"text-sm text-green-600",children:["Rp ",e.income.toLocaleString("id-ID")]}),(0,t.jsxs)("div",{className:"text-sm text-red-600",children:["Rp ",e.expense.toLocaleString("id-ID")]}),(0,t.jsxs)("div",{className:"text-sm ".concat(e.balance>=0?"text-blue-600":"text-red-600"),children:["Rp ",e.balance.toLocaleString("id-ID")]})]})]},e.month))]})})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Tabel Data Bulanan"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bulan"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pemasukan"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pengeluaran"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo"})]})}),(0,t.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[c.monthlyData.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:m[e.month-1]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:["Rp ",e.income.toLocaleString("id-ID")]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:["Rp ",e.expense.toLocaleString("id-ID")]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,t.jsxs)("span",{className:e.balance>=0?"text-green-600":"text-red-600",children:["Rp ",e.balance.toLocaleString("id-ID")]})})]},e.month)),(0,t.jsxs)("tr",{className:"bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:"Total"}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-green-600",children:["Rp ",c.totalIncome.toLocaleString("id-ID")]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-red-600",children:["Rp ",c.totalExpense.toLocaleString("id-ID")]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold",children:(0,t.jsxs)("span",{className:c.yearBalance>=0?"text-green-600":"text-red-600",children:["Rp ",c.yearBalance.toLocaleString("id-ID")]})})]})]})]})})]})]}):(0,t.jsx)("p",{className:"text-gray-500",children:"Pilih tahun untuk melihat laporan."})]})})}function K(){let[e,a]=(0,r.useState)(null),[s,m]=(0,r.useState)(!0),[h,u]=(0,r.useState)(null),[g,p]=(0,r.useState)("dashboard"),[b,j]=(0,r.useState)(!1),f=(0,r.useCallback)(async()=>{try{m(!0);let e=await fetch("/api/finance");if(!e.ok)throw Error("Gagal mengambil data keuangan");let s=await e.json();a(s),u(null)}catch(e){console.error("Error fetching finance data:",e),u("Terjadi kesalahan saat mengambil data. Silakan coba lagi.")}finally{m(!1)}},[]);(0,r.useEffect)(()=>{f()},[f]);let y=async e=>{try{let a=await fetch("/api/finance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"Gagal menambahkan transaksi")}return f(),{success:!0}}catch(e){return console.error("Error adding transaction:",e),{success:!1,error:e instanceof Error?e.message:"Terjadi kesalahan tidak diketahui"}}},v=async e=>{try{let a=await fetch("/api/finance?id=".concat(e),{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.error||"Gagal menghapus transaksi")}return f(),{success:!0}}catch(e){return console.error("Error deleting transaction:",e),{success:!1,error:e instanceof Error?e.message:"Terjadi kesalahan tidak diketahui"}}},w=async(e,a)=>{try{let s=await fetch("/api/finance",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...a})});if(!s.ok){let e=await s.json();throw Error(e.error||"Gagal mengupdate transaksi")}return f(),{success:!0}}catch(e){return console.error("Error updating transaction:",e),{success:!1,error:e instanceof Error?e.message:"Terjadi kesalahan tidak diketahui"}}},k=[{id:"dashboard",name:"Dashboard",icon:l.A,description:"Ringkasan keuangan"},{id:"add-transaction",name:"Tambah Transaksi",icon:i.A,description:"Input transaksi baru"},{id:"transactions",name:"Daftar Transaksi",icon:c.A,description:"Kelola semua transaksi"},{id:"monthly-report",name:"Laporan Bulanan",icon:d.A,description:"Analisis per bulan"},{id:"yearly-report",name:"Laporan Tahunan",icon:o.A,description:"Analisis per tahun"}];return s?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Memuat data keuangan..."})]})}):h?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Terjadi Kesalahan"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:h}),(0,t.jsx)("button",{onClick:f,className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200",children:"Coba Lagi"})]})})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("button",{onClick:()=>j(!b),className:"lg:hidden p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100",children:(0,t.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,t.jsx)("div",{className:"ml-2 lg:ml-0",children:(0,t.jsxs)("h1",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[(0,t.jsx)(x.A,{className:"h-6 w-6 text-green-600 mr-2"}),"Manajemen Kas Masjid"]})})]}),e&&(0,t.jsx)("div",{className:"hidden sm:block",children:(0,t.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg px-4 py-2",children:[(0,t.jsxs)("div",{className:"text-sm text-green-800 font-medium",children:["Saldo Kas: Rp ",e.currentBalance.toLocaleString("id-ID")]}),(0,t.jsxs)("div",{className:"text-xs text-green-600",children:["Terakhir diperbarui: ",(0,n.GP)(new Date(e.lastUpdated),"dd MMM yyyy, HH:mm")]})]})})]})})}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"".concat(b?"translate-x-0":"-translate-x-full"," lg:translate-x-0 transition-transform duration-300 ease-in-out lg:static absolute inset-y-0 left-0 z-40 w-64 bg-white shadow-lg lg:shadow-none border-r border-gray-200"),children:(0,t.jsx)("div",{className:"h-full flex flex-col",children:(0,t.jsx)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:(0,t.jsx)("nav",{className:"mt-5 flex-1 px-2 space-y-2",children:k.map(e=>{let a=e.icon;return(0,t.jsxs)("button",{onClick:()=>{p(e.id),j(!1)},className:"".concat(g===e.id?"bg-green-100 border-green-500 text-green-700":"border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900"," w-full group border-l-4 py-3 px-3 flex items-start text-left transition-colors duration-200"),children:[(0,t.jsx)(a,{className:"".concat(g===e.id?"text-green-500":"text-gray-400"," mr-3 flex-shrink-0 h-5 w-5 transition-colors duration-200")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-xs mt-1 opacity-75",children:e.description})]})]},e.id)})})})})}),b&&(0,t.jsx)("div",{className:"lg:hidden fixed inset-0 z-30 bg-gray-600 bg-opacity-75",onClick:()=>j(!1)}),(0,t.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:(0,t.jsx)("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:(0,t.jsx)("div",{className:"py-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e&&(0,t.jsx)("div",{className:"sm:hidden mb-6",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-4 text-white",children:[(0,t.jsxs)("div",{className:"text-lg font-semibold",children:["Rp ",e.currentBalance.toLocaleString("id-ID")]}),(0,t.jsxs)("div",{className:"text-sm opacity-90",children:["Saldo Kas • ",(0,n.GP)(new Date(e.lastUpdated),"dd MMM yyyy")]})]})}),(0,t.jsxs)("div",{className:"transition-all duration-300 ease-in-out",children:["dashboard"===g&&e&&(0,t.jsx)(R,{transactions:e.transactions,currentBalance:e.currentBalance}),"add-transaction"===g&&(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsx)(N,{onSubmit:y,onCancel:()=>p("dashboard")})}),"transactions"===g&&e&&(0,t.jsx)(C,{transactions:e.transactions,onDelete:v,onUpdate:w}),"monthly-report"===g&&(0,t.jsx)(E,{}),"yearly-report"===g&&(0,t.jsx)(F,{})]})]})})})})]})]})}}}]);